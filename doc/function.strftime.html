
strftime

(PHP 4, PHP 5, PHP 7)

strftime — 根据区域设置格式化本地时间／日期

说明

string strftime ( string $format [, int $timestamp = time() ] )

返回用给定的格式字串对给出的 timestamp 进行格式输出后的字符串。如果没有给出时间
戳则用当前的本地时间。月份和星期几以及其它和语言有关的字符串写法和用 setlocale
() 设定的当前的区域有关。

可能不是所有的转换标记都被 C 库文件支持，这种情况下 PHP 的 strftime() 也不支持
。此外，不是所有的平台都支持负的时间戳，因此日期的范围可能限定在不早于 Unix 纪
元。这意味着例如 %e, %T，%R 和 %D（可能更多）以及早于 Jan 1, 1970 的时间在
Windows，一些 Linux 发行版本，以及其它几个操作系统中无效。对于 Windows 系统，所
支持的转换标记可在 » MSDN 网站找到。

参数

format

                    format 里能够识别的格式字串有以下标记：
    格式                       描述                            返回值示例
    日    ---                                             ---
    %a    当前区域星期几的简写                            Sun 到 Sat
    %A    当前区域星期几的全称                            Sunday 到 Saturday
    %d    月份中的第几天，十进制数字（范围从 01 到 31）   01 到 31
          月份中的第几天，十进制数字，一位的数字前会加上
    %e    一个空格（范围从 ' 1' 到 '31'）在 Windows 上尚  1 到 31
          未按描述实现。更多信息见下方。
    %j    年份中的第几天，带前导零的三位十进制数（范围从  001 到 366
          001 到 366）
    %u    符合 ISO-8601 星期几的十进制数表达 [1,7]，1 表  1 (星期一) 到 7 (星期
          示星期一                                        日)
    %w    星期中的第几天，星期天为 0                      0 (星期天) 到 6 (星期
                                                          六)
    周    ---                                             ---
    %U    本年的第几周，从第一周的第一个星期天作为第一天  13 (for the 13th full
          开始                                            week of the year)
          %V - 本年第几周的 ISO-8601:1988 格式，范围从 01 01 到 53 (where 53
    %V    到 53，第 1 周是本年第一个至少还有 4 天的星期， accounts for an
          星期一作为每周的第一天。（用 %G 或者 %g 作为指  overlapping week)
          定时间戳相应周数的年份组成。）
          本年的第几周数，从第一周的第一个星期一作为第一  46 (for the 46th week
    %W    天开始                                          of the year beginning
                                                          with a Monday)
    月    ---                                             ---
    %b    当前区域月份的简写                              Jan 到 Dec
    %B    当前区域月份的全称                              January 到 December
    %h    当前区域月份的简写（%b 的别名）                 Jan 到 Dec
    %m    两位数的月份                                    01 (是一月份) 到 12
                                                          (是十二月份)
    年    ---                                             ---
    %C    两位数显示世纪（年份除以 100，截成整数）        19 是 20 世纪
          2 位数的年份，符合 ISO-8601:1988 星期数（参见   比如：2009年1月6日那
    %g    %V）。和 %V 的格式和值一样，只除了如果 ISO 星期 一周是 09。
          数属于前一年或者后一年，则使用那一年。
    %G    %g 的完整四位数版本                             比如：2009年1月3日那
                                                          一周是 2008.
    %y    两位数显示年份                                  比如： 09 是 2009，79
                                                          是 1979
    %Y    四位数显示年份                                  比如： 2038
    时间  ---                                             ---
    %H    以 24 小时格式显示两位小时数                    00 到 23
    %I    以 12 小时格式显示两位小时数                    01 到 12
    %l（
    'L'   以 12 小时格式显示小时数，单个数字前含空格      1 到 12
    的小
    写）
    %M    两位的分钟数                                    00 到 59
    %p    指定时间的大写 “AM” 或 “PM”                     比如： 00:31 是 AM ，
                                                          22:23 是PM
    %P    指定时间的小写 “am” 或 “pm”                     比如：00:31 是 am ，
                                                          22:23 是pm
    %r    和 "%I:%M:%S %p" 一样                           比如： 21:34:17 是
                                                          09:34:17 PM
                                                          比如： 12:35 AM 是
    %R    和 "%H:%M" 一样                                 00:35，4:44 PM 是
                                                          16:44
    %S    两位数字表示秒                                  00 到 59
    %T    和 "%H:%M:%S" 一样                              比如： 09:34:17 PM 是
                                                          21:34:17
    %X    当前区域首选的时间表示法，不包括日期            例如： 03:59:16 或
                                                          15:59:16
    %z    从 UTC 的时区偏移或简写（由操作系统决定）       比如：东部时间是
                                                          -0500 或 EST
    %Z    %z 没有给出的 UTC 的时区偏移或简写（由操作系统  比如： -0500 或 EST
          决定）                                          是东部时间
    时间
    和日  ---                                             ---
    期戳
                                                          比如： 2009 年 2 月 5
    %c    当前区域首选的日期时间表达                      日上午 12:45:10 是
                                                          Tue Feb 5 00:45:10
                                                          2009
    %D    和 "%m/%d/%y" 一样                              比如： 2009 年 2 月 5
                                                          日是 02/05/09
    %F    Same as "%Y-%m-%d" (commonly used in database   比如：2009 年 2 月 5
          datestamps)                                     日是 2009-02-05
                                                          比如： 1979 年 9 月
    %s    Unix纪元的时间戳（和 time() 函数一样）          10 日上午 8 点 40 分
                                                          00 秒是 305815200
    %x    当前区域首选的时间表示法，不包括时间            比如： 2009 年 2 月 5
                                                          日是 02/05/09
    其他  ---                                             ---
    %n    换行符("\n")                                    ---
    %t    Tab 字符("\t")                                  ---
    %%    文字上的百分字符("%")                           ---

    这个参数的最大长度是 1023 个字符。

    Warning

    尽管 ISO 9889:1999（当前的 C 标准）明确指出一周从星期一开始，但是 Sun
    Solaris 的一周似乎从星期天开始并作为 1。所以 %u 的结果也许不会和手册里描述
    得一样。

    Warning

    仅针对 Windows：这个函数里 %e 修饰符修饰符还不能支持 Windows。为了得到这个
    值可以用 %#d 修饰符来代替。下例说明了如何写一个跨平台支持的函数。

    Warning

    仅针对 Mac OS X：这个函数里 %P 修饰符还不能支持 Mac OS X。

timestamp

    可选的 timestamp 参数是一个 integer 的 Unix 时间戳，如未指定，参数值默认为
    当前本地时间。也就是说，其值默认为 time() 的返回值。

返回值

根据指定的 timestamp 或未给出 timestamp 是使用当前本地时间，返回 format 格式化
的字符。月份、星期名和其他与语言相关的字符串遵守 setlocale() 设置的当前区域设置
。

错误／异常

在每次调用日期/时间函数时，如果时区无效则会引发 E_NOTICE 错误，如果使用系统设定
值或 TZ 环境变量，则会引发 E_STRICT 或 E_WARNING 消息。参见 
date_default_timezone_set()。

由于输出依赖于 C 库，所以一些转换标记并不被支持。在 Windows 上，使用未知的转换
标记将导致 5 E_WARNING 信息，并返回 FALSE。在其他的操作系统上，你可能不能得到任
何 E_WARNING 信息，并且可能输出未经转换的转换标记。

更新日志

版本                    说明
5.1.0 现在发布 E_STRICT 和 E_NOTICE 时区错误。

范例

如果你的系统里安装了各自的语言环境则下例能够正常运行。

Example #1 strftime() 区域的例子

<?php
setlocale(LC_TIME, "C");
echo strftime("%A");
setlocale(LC_TIME, "fi_FI");
echo strftime(" in Finnish is %A,");
setlocale(LC_TIME, "fr_FR");
echo strftime(" in French %A and");
setlocale(LC_TIME, "de_DE");
echo strftime(" in German %A.\n");
?>

Example #2 ISO 8601:1988 week number example

<?php
/*     December 2002 / January 2003
ISOWk  M   Tu  W   Thu F   Sa  Su
----- ----------------------------
51     16  17  18  19  20  21  22
52     23  24  25  26  27  28  29
1      30  31   1   2   3   4   5
2       6   7   8   9  10  11  12
3      13  14  15  16  17  18  19   */

// 输出： 12/28/2002 - %V,%G,%Y = 52,2002,2002
echo "12/28/2002 - %V,%G,%Y = " . strftime("%V,%G,%Y", strtotime("12/28/2002"))
 . "\n";

// 输出： 12/30/2002 - %V,%G,%Y = 1,2003,2002
echo "12/30/2002 - %V,%G,%Y = " . strftime("%V,%G,%Y", strtotime("12/30/2002"))
 . "\n";

// 输出： 1/3/2003 - %V,%G,%Y = 1,2003,2003
echo "1/3/2003 - %V,%G,%Y = " . strftime("%V,%G,%Y",strtotime("1/3/2003")) . "\
n";

// 输出： 1/10/2003 - %V,%G,%Y = 2,2003,2003
echo "1/10/2003 - %V,%G,%Y = " . strftime("%V,%G,%Y",strtotime("1/10/2003")) . 
"\n";



/*     December 2004 / January 2005
ISOWk  M   Tu  W   Thu F   Sa  Su
----- ----------------------------
51     13  14  15  16  17  18  19
52     20  21  22  23  24  25  26
53     27  28  29  30  31   1   2
1       3   4   5   6   7   8   9
2      10  11  12  13  14  15  16   */

// 输出： 12/23/2004 - %V,%G,%Y = 52,2004,2004
echo "12/23/2004 - %V,%G,%Y = " . strftime("%V,%G,%Y",strtotime("12/23/2004"))
 . "\n";

// 输出： 12/31/2004 - %V,%G,%Y = 53,2004,2004
echo "12/31/2004 - %V,%G,%Y = " . strftime("%V,%G,%Y",strtotime("12/31/2004"))
 . "\n";

// 输出： 1/2/2005 - %V,%G,%Y = 53,2004,2005
echo "1/2/2005 - %V,%G,%Y = " . strftime("%V,%G,%Y",strtotime("1/2/2005")) . "\
n";

// 输出： 1/3/2005 - %V,%G,%Y = 1,2005,2005
echo "1/3/2005 - %V,%G,%Y = " . strftime("%V,%G,%Y",strtotime("1/3/2005")) . "\
n";

?>

Example #3 %e 修改器跨平台兼容的例子

<?php

// Jan 1: results in: '%e%1%' (%%, e, %%, %e, %%)
$format = '%%e%%%e%%';

// Check for Windows to find and replace the %e 
// modifier correctly
if (strtoupper(substr(PHP_OS, 0, 3)) == 'WIN') {
    $format = preg_replace('#(?<!%)((?:%%)*)%e#', '</refsect1>%#d', $format);
}

echo strftime($format);
?>

Example #4 显示所有已知和未知的格式

<?php
// Describe the formats.
$strftimeFormats = array(
    'A' => 'A full textual representation of the day',
    'B' => 'Full month name, based on the locale',
    'C' => 'Two digit representation of the century 
(year divided by 100, truncated to an integer)',
    'D' => 'Same as "%m/%d/%y"',
    'E' => '',
    'F' => 'Same as "%Y-%m-%d"',
    'G' => 'The full four-digit version of %g',
    'H' => 'Two digit representation of the hour in 24-hour format',
    'I' => 'Two digit representation of the hour in 12-hour format',
    'J' => '',
    'K' => '',
    'L' => '',
    'M' => 'Two digit representation of the minute',
    'N' => '',
    'O' => '',
    'P' => 'lower-case "am" or "pm" based on the given time',
    'Q' => '',
    'R' => 'Same as "%H:%M"',
    'S' => 'Two digit representation of the second',
    'T' => 'Same as "%H:%M:%S"',
    'U' => 
'Week number of the given year, starting with the first Sunday as the first week'
,
    'V' => 
'ISO-8601:1988 week number of the given year, starting with the first week of the year with at least 4 weekdays, with Monday being the start of the week'
,
    'W' => 
'A numeric representation of the week of the year, starting with the first Monday as the first week'
,
    'X' => 'Preferred time representation based on locale, without the date',
    'Y' => 'Four digit representation for the year',
    'Z' => 'The time zone offset/abbreviation option NOT given by %z 
(depends on operating system)',
    'a' => 'An abbreviated textual representation of the day',
    'b' => 'Abbreviated month name, based on the locale',
    'c' => 'Preferred date and time stamp based on local',
    'd' => 'Two-digit day of the month (with leading zeros)',
    'e' => 'Day of the month, with a space preceding single digits',
    'f' => '',
    'g' => 
'Two digit representation of the year going by ISO-8601:1988 standards (see %V)
',
    'h' => 'Abbreviated month name, based on the locale (an alias of %b)',
    'i' => '',
    'j' => 'Day of the year, 3 digits with leading zeros',
    'k' => '',
    'l' => 'Hour in 12-hour format, with a space preceeding single digits',
    'm' => 'Two digit representation of the month',
    'n' => 'A newline character ("\n")',
    'o' => '',
    'p' => 'UPPER-CASE "AM" or "PM" based on the given time',
    'q' => '',
    'r' => 'Same as "%I:%M:%S %p"',
    's' => 'Unix Epoch Time timestamp',
    't' => 'A Tab character ("\t")',
    'u' => 'ISO-8601 numeric representation of the day of the week',
    'v' => '',
    'w' => 'Numeric representation of the day of the week',
    'x' => 'Preferred date representation based on locale, without the time',
    'y' => 'Two digit representation of the year',
    'z' => 'Either the time zone offset from UTC or the abbreviation 
(depends on operating system)',
    '%' => 'A literal percentage character ("%")',
);

// Results.
$strftimeValues = array();

// Evaluate the formats whilst suppressing any errors.
foreach($strftimeFormats as $format => $description){
    if (False !== ($value = @strftime("%{$format}"))){
        $strftimeValues[$format] = $value;
    }
}

// Find the longest value.
$maxValueLength = 2 + max(array_map('strlen', $strftimeValues));

// Report known formats.
foreach($strftimeValues as $format => $value){
    echo "Known format   : '{$format}' = ", str_pad("'{$value}'", 
$maxValueLength), " ( {$strftimeFormats[$format]} )\n";
}

// Report unknown formats.
foreach(array_diff_key($strftimeFormats, $strftimeValues) as $format => 
$description){
    echo "Unknown format : '{$format}'   ", str_pad(' ', $maxValueLength), (
$description ? " ( {$description} )" : ''), "\n";
}
?>

以上例程的输出类似于：

Known format   : 'A' = 'Friday'            ( A full textual representation of the day )
Known format   : 'B' = 'December'          ( Full month name, based on the locale )
Known format   : 'H' = '11'                ( Two digit representation of the hour in 24-hour format )
Known format   : 'I' = '11'                ( Two digit representation of the hour in 12-hour format )
Known format   : 'M' = '24'                ( Two digit representation of the minute )
Known format   : 'S' = '44'                ( Two digit representation of the second )
Known format   : 'U' = '48'                ( Week number of the given year, starting with the first Sunday as the first week )
Known format   : 'W' = '48'                ( A numeric representation of the week of the year, starting with the first Monday as the first week )
Known format   : 'X' = '11:24:44'          ( Preferred time representation based on locale, without the date )
Known format   : 'Y' = '2010'              ( Four digit representation for the year )
Known format   : 'Z' = 'GMT Standard Time' ( The time zone offset/abbreviation option NOT given by %z (depends on operating system) )
Known format   : 'a' = 'Fri'               ( An abbreviated textual representation of the day )
Known format   : 'b' = 'Dec'               ( Abbreviated month name, based on the locale )
Known format   : 'c' = '12/03/10 11:24:44' ( Preferred date and time stamp based on local )
Known format   : 'd' = '03'                ( Two-digit day of the month (with leading zeros) )
Known format   : 'j' = '337'               ( Day of the year, 3 digits with leading zeros )
Known format   : 'm' = '12'                ( Two digit representation of the month )
Known format   : 'p' = 'AM'                ( UPPER-CASE "AM" or "PM" based on the given time )
Known format   : 'w' = '5'                 ( Numeric representation of the day of the week )
Known format   : 'x' = '12/03/10'          ( Preferred date representation based on locale, without the time )
Known format   : 'y' = '10'                ( Two digit representation of the year )
Known format   : 'z' = 'GMT Standard Time' ( Either the time zone offset from UTC or the abbreviation (depends on operating system) )
Known format   : '%' = '%'                 ( A literal percentage character ("%") )
Unknown format : 'C'                       ( Two digit representation of the century (year divided by 100, truncated to an integer) )
Unknown format : 'D'                       ( Same as "%m/%d/%y" )
Unknown format : 'E'
Unknown format : 'F'                       ( Same as "%Y-%m-%d" )
Unknown format : 'G'                       ( The full four-digit version of %g )
Unknown format : 'J'
Unknown format : 'K'
Unknown format : 'L'
Unknown format : 'N'
Unknown format : 'O'
Unknown format : 'P'                       ( lower-case "am" or "pm" based on the given time )
Unknown format : 'Q'
Unknown format : 'R'                       ( Same as "%H:%M" )
Unknown format : 'T'                       ( Same as "%H:%M:%S" )
Unknown format : 'V'                       ( ISO-8601:1988 week number of the given year, starting with the first week of the year with at least 4 weekdays, with Monday being the start of the week )
Unknown format : 'e'                       ( Day of the month, with a space preceding single digits )
Unknown format : 'f'
Unknown format : 'g'                       ( Two digit representation of the year going by ISO-8601:1988 standards (see %V) )
Unknown format : 'h'                       ( Abbreviated month name, based on the locale (an alias of %b) )
Unknown format : 'i'
Unknown format : 'k'
Unknown format : 'l'                       ( Hour in 12-hour format, with a space preceeding single digits )
Unknown format : 'n'                       ( A newline character ("\n") )
Unknown format : 'o'
Unknown format : 'q'
Unknown format : 'r'                       ( Same as "%I:%M:%S %p" )
Unknown format : 's'                       ( Unix Epoch Time timestamp )
Unknown format : 't'                       ( A Tab character ("\t") )
Unknown format : 'u'                       ( ISO-8601 numeric representation of the day of the week )
Unknown format : 'v'

注释

    Note: %G 和 %V，如果数字编号系统未能充分理解，基于 ISO 8601:1988 的星期数可
    能得出未预期的结果。见上面的 %V 和以下的例子。

参见

  • » 在线 strftime() 格式设计工具
  • setlocale() - 设置地区信息
  • mktime() - 取得一个日期的 Unix 时间戳
  • strptime() - 解析由 strftime 生成的日期／时间
  • gmstrftime() - 根据区域设置格式化 GMT/UTC 时间／日期
  • » Open Group specification of strftime()


User Contributed Notes 32 notes

===============================================================================

If strange characters are returned use utf8_encode(strftime()) for UTF-8
characters
===============================================================================

strftime not format microsecond (decimal part of seconds).
This function add '%f' key in format to render microsecond (6 digits) also.

<?php
/**
* @param string $format strftime format
* @param float $microtime time with microsecond
* @return string
*/
function strftimeu($format, $microtime)
{
    if (preg_match('/^[0-9]*\\.([0-9]+)$/', $microtime, $reg)) {
        $decimal = substr(str_pad($reg[1], 6, "0"), 0, 6);
    } else {
        $decimal = "000000";
    }
    $format = preg_replace('/(%f)/', $decimal, $format);
    return strftime($format, $microtime);
}
?>

Example :
<?php
$now=microtime(true);
printf("REF:%s\n",$now );
printf("FMT:%s\n", strftimeu('%H:%M:%S.%f', $now));
?>

Results are :
REF:1393937303.6615
FMT:13:48:23.661500
FMT:13h 48min 23s 661500µs

Note : Here the decimal part of microtime is on 4 digits due to default
precision
===============================================================================

This is what worked in my case:

<?php
    setlocale(LC_ALL, 'es_ES').': ';
    echo iconv('ISO-8859-1', 'UTF-8', strftime('%A %d de %B de %Y', time()));
    ?>

it displays: miércoles 22 de octubre de 2008
===============================================================================

Under windows if you are using Japanese version, you must use the following
code:

setlocale(LC_ALL, "Japanese_Japan.20932") for EUC
setlocale(LC_ALL, "Japanese_Japan.932") for SJIS

I found the following page that helped me with this issue:
http://moodle.org/mod/forum/discuss.php?d=8329
===============================================================================

Function strftime() use the locales installed in your system (linux).

If you are like me and only leave in the system the locales you use normally
(en_US and your own language locale, like es_ES), you'll only be able to use
the locales installed. If your application is translated to other languages,
you need these locales too.

The name of the locale in your system is important too. This can be a problem
when you want to distribute the app.

If you have this locales in your system:
en_US/ISO-8859-1
en_US.UTF-8/UTF-8
es_ES/ISO-8859-1
es_ES@euro/ISO-8859-15
es_ES.UTF-8/UTF-8
es_ES@euro/UTF-8

and use setlocale('es_ES'), the result will use the iso-8859-1 charset even if
you have all your system, files and configuration options in UTF-8. To receive
content in UTF-8, in this example, you need to use setlocale('es_ES.UTF-8') or
setlocale('es_ES.UTF-8@UTF-8').

The definition of locales can change from one system to another, and so the
charset from the results.
===============================================================================

Here's a simple version for date formating i use between displaying in HTML and
converting back to MYSQL format:

<?php
function format_date($original='', $format="%m/%d/%Y") {
    $format = ($format=='date' ? "%m-%d-%Y" : $format);
    $format = ($format=='datetime' ? "%m-%d-%Y %H:%M:%S" : $format);
    $format = ($format=='mysql-date' ? "%Y-%m-%d" : $format);
    $format = ($format=='mysql-datetime' ? "%Y-%m-%d %H:%M:%S" : $format);
    return (!empty($original) ? strftime($format, strtotime($original)) : "" );
}
?>

example (in HTML or webapp):
[grab from database]...
$dbase_stored_date = "2007-03-15";
$display_html_date = format_date($dbase_stored_date);
... displays as "03/15/2007"

example (saving form via on POST/GET):
$update_date = format_date($_POST['display_html_date'], 'mysql-date');
// converts back to '2007-03-15'
.... [your mysql update here]

Don't forget to sanitize your POST/GET's   =)
===============================================================================

The following function implements the conversion specifiers which are not
supported on Win32 platforms:

(Note: the specifiers %V, %G and %g can be implemented using other functions
described in this section)

<?php

function strftime_win32($format, $ts = null) {
    if (!$ts) $ts = time();

    $mapping = array(
        '%C' => sprintf("%02d", date("Y", $ts) / 100),
        '%D' => '%m/%d/%y',
        '%e' => sprintf("%' 2d", date("j", $ts)),
        '%h' => '%b',
        '%n' => "\n",
        '%r' => date("h:i:s", $ts) . " %p",
        '%R' => date("H:i", $ts),
        '%t' => "\t",
        '%T' => '%H:%M:%S',
        '%u' => ($w = date("w", $ts)) ? $w : 7
    );
    $format = str_replace(
        array_keys($mapping),
        array_values($mapping),
        $format
    );

    return strftime($format, $ts);
}

?>
===============================================================================

This worked for me to distinguish between windows and linux, for stripping
leading zeros from days/months in the short formats (like for Czech):
stristr(PHP_OS,"win") ? "%#d.%#m.%Y" : "%-d.%-m.%Y"
===============================================================================

On the Linux server I'm using, strftime() also accepts a "-" option to request
no padding:

<?php
$ts = strtotime("4 Nov 2009");
echo strlen(strftime("%-e", $ts)), "\n"; // "1" (no padding)
echo strlen(strftime("%e", $ts)), "\n"; // "2" (space padded)
?>
===============================================================================

This is that worked with UTF-8 encoding on Linux server, with right accents:
<?php
setlocale(LC_ALL, 'hu_HU.UTF8');
echo(strftime('%Y. %B %d. %A'));
?>

Output is:
2009. november 02. hétfő

Also, this one can be used, if not utf-8 preferred:
<?php
setlocale(LC_ALL, 'hu_HU.ISO8859-2');
?>

UTF-8 is not supported on windows platforms, so there the iconv workaround must
be used:
<?php
setlocale(LC_ALL, 'hun_hun');
echo(iconv('ISO-8859-2', 'UTF-8',strftime('%Y. %B %d. %A')));
?>

The output is the same as before. Note that, the iconv first parameter is
ISO-8859-2 not ISO-8859-1, because the locale is hungarian which uses 8859-2
codepage as default. It is needed for the right accents.

If you want use the same code for Windows and Linux platforms, the second one
is the right option (the iconv trick), but the locale configuration must be
different (Linux: hu_HU, windows: hun_hun), but in that case the UTF8 tag is
not needed for the Linux config.
===============================================================================

(in addition to Andy's post)
To get a RFC 2822 date (used in RSS) of the current local time :

echo strftime ("%a, %d %b %Y %H:%M:%S %z") ;

Note: option %z / %Z - work different on Windows platform, for example
output of this code line can be:
Thu, 02 Nov 2006 09:54:59 Jerusalem Standard Time (on Windows)
Thu, 02 Nov 2006 09:54:59 +0200                   (on Linux)

[red. It is much smarter to use date(DATE_RSS); here]
===============================================================================

%p and %P replaced to '' in ru and other locales so 20:10 in %I:%M %p will be
08:10 in russian (without pm)
===============================================================================

more fixed Problems while uing strftime in win32-systems.

        function strftime_win32($format, $ts = null) {
                if (!$ts) $ts = time();
       
                $mapping = array(
                                '%C' => sprintf("%02d", date("Y", $ts) / 100),
                                '%D' => '%m/%d/%y',
                                '%e' => sprintf("%' 2d", date("j", $ts)),
                                '%h' => '%b',
                                '%n' => "\n",
                                '%r' => date("h:i:s", $ts) . " %p",
                                '%R' => date("H:i", $ts),
                                '%t' => "\t",
                                '%T' => '%H:%M:%S',
                                '%u' => ($w = date("w", $ts)) ? $w : 7
                );
                $format = str_replace(
                                array_keys($mapping),
                                array_values($mapping),
                                $format
                );
               
                if($format=='%V' or $format=='%G' or $format=='%g'){
                        // When strftime("%V") fails, some unoptimized
workaround
                        //
                        // http://en.wikipedia.org/wiki/ISO_8601 : week 1 is
"the week with the year's first Thursday in it (the formal ISO definition)"

                       
                        $year = strftime("%Y", $ts);
                        $isoyear=$year;
                       
                        $first_day = strftime("%w", mktime(0, 0, 0, 1, 1,
$year));
                        $last_day = strftime("%w", mktime(0, 0, 0, 12, 31,
$year));
                       
                        $number = $isonumber = strftime("%W", $ts);
                       
                        // According to strftime("%W"), 1st of january is in
week 1 if and only if it is a monday
                        if ($first_day == 1) {
                                $isonumber--;
                        }
                       
                        // 1st of january is between monday and thursday;
starting (now) at 0 when it should be 1
                        if ($first_day >= 1 && $first_day <= 4){
                                $isonumber++;
                                $isoyear=$year;
                        }elseif ($number == 0){
                                $isonumber = mktime(0, 0, 0, 12, 31, $year -
1);
                                $isoyear=$year;
                        }
                        if ($isonumber == 53 && ($last_day == 1 || $last_day ==
2 || $last_day == 3)){
                                $isonumber = 1;
                                $isoyear=$year+1;
                        }
                        if ($format=='%V') {
                                return sprintf("%02d", $isonumber);
                        }elseif ($format=='%G'){
                                return sprintf("%04d", $isoyear);
                        }elseif ($format=='%g'){
                                return substr(sprintf("%04d", $isoyear),-2);
                        }
                       
                               
                }else{
                        return strftime($format, $ts);
                }
        }
===============================================================================

Created this small method to convert a date format to a strftime format. One
format is enough to learn :)

<?php
/**
* Convert a date format to a strftime format
*
* Timezone conversion is done for unix. Windows users must exchange %z and %Z.
*
* Unsupported date formats : S, n, t, L, B, G, u, e, I, P, Z, c, r
* Unsupported strftime formats : %U, %W, %C, %g, %r, %R, %T, %X, %c, %D, %F, %x
*
* @param string $dateFormat a date format
* @return string
*/
public static function dateFormatToStrftime($dateFormat) {
   
    $caracs = array(
        // Day - no strf eq : S
        'd' => '%d', 'D' => '%a', 'j' => '%e', 'l' => '%A', 'N' => '%u', 'w' =>
'%w', 'z' => '%j',
        // Week - no date eq : %U, %W
        'W' => '%V', 
        // Month - no strf eq : n, t
        'F' => '%B', 'm' => '%m', 'M' => '%b',
        // Year - no strf eq : L; no date eq : %C, %g
        'o' => '%G', 'Y' => '%Y', 'y' => '%y',
        // Time - no strf eq : B, G, u; no date eq : %r, %R, %T, %X
        'a' => '%P', 'A' => '%p', 'g' => '%l', 'h' => '%I', 'H' => '%H', 'i' =>
'%M', 's' => '%S',
        // Timezone - no strf eq : e, I, P, Z
        'O' => '%z', 'T' => '%Z',
        // Full Date / Time - no strf eq : c, r; no date eq : %c, %D, %F, %x 
        'U' => '%s'
    );
   
    return strtr((string)$dateFormat, $caracs);
}
?>

I use it with this condition on a date format :
if(preg_match("/(D|l|F|M)/", $format))
===============================================================================

For windows user:

If you unsuccessfully change date/time format to your locale country using
xx_XX format, try using XXX format or ISO-639 country codes format.

See complete list for ISO-639 here: http://www.w3.org/WAI/ER/IG/ert/iso639.htm

For example:

<?php
setlocale(LC_ALL, 'IND');
echo strftime("Today in Indonesia is %A");
?>
===============================================================================

note, that for some languages you MUST set LC_ALL instead of LC_TIME.

note that you further have to explicitly define your output-encoding (default
is ISO-8859-1 [which makes problems for some languages])!

at least i expirienced this behaviour on a german WinXP-PHP4 environment:

<?php

// does not work - gives question marks:
setlocale(LC_TIME, 'RUS'); // ISO Alpha-3 is supported by xp
echo strftime('%A', time());

?>

<?php

// DOES work:
header('Content-Type: text/html; charset=UTF-8'); // you could also use another
charset here if iconv isn't installed on your system.

echo setlocale(LC_ALL, 'RUS').': ';
echo iconv('windows-1251', 'UTF-8', strftime('%A', time()))."\n";

?>
===============================================================================

<?php
/*
*    This function figures out what fiscal year a specified date is in.
*    $inputDate - the date you wish to find the fiscal year for. (12/4/08)
*    $fyStartDate - the month and day your fiscal year starts. (7/1)
*    $fyEndDate - the month and day your fiscal year ends. (6/30)
*    $fy - returns the correct fiscal year
*/
function calculateFiscalYearForDate($inputDate, $fyStart, $fyEnd){
    $date = strtotime($inputDate);
    $inputyear = strftime('%Y',$date);
       
    $fystartdate = strtotime($fyStart.$inputyear);
    $fyenddate = strtotime($fyEnd.$inputyear);

    if($date < $fyenddate){
        $fy = intval($inputyear);
    }else{
        $fy = intval(intval($inputyear) + 1);
    }
   
    return $fy;
   
}

// my fiscal year starts on July,1 and ends on June 30, so...
echo calculateFiscalYearForDate("5/15/08","7/1","6/30");
// returns 2008

echo calculateFiscalYearForDate("12/1/08","7/1","6/30");
// returns 2009
?>
===============================================================================

If moving from date() to strftime() to support additional languages, you may
miss the ordinal suffix format option date('S'). Workaround this by adding an
extra modifier (%O).

<?php
function my_strftime ($format, $timestamp)
{
    $format = str_replace('%O', date('S', $timestamp), $format);   
    return strftime($format, $timestamp);
}
?>
===============================================================================

The example of the workarround for the %e modifier is a bit complex. Sometime
you might want to prefer a simple ltrim():

<?php
ltrim(strftime('%d', $time), '0');
?>
===============================================================================

%V may fail with some systems (Windows XP, at least). Here is a function that
should work to get the week number of a day (timestamped), according to ISO
8601.

"should work" as in "it is working with my understanding of this norm", where
1st of january can be week 52, 53 or 01. Hopefully.

testing (php_uname("s") == "Windows NT") or equivalent can be an option (when
switching between Wampserver and a GNU server, for instance).

Please, erase and correct my message if there is any error.

<?php
function week_isonumber ($time) {
// When strftime("%V") fails, some unoptimized workaround
//
// http://en.wikipedia.org/wiki/ISO_8601 : week 1 is "the week with the year's
first Thursday in it (the formal ISO definition)"

    $year = strftime("%Y", $time);

    $first_day = strftime("%w", mktime(0, 0, 0, 1, 1, $year));
    $last_day = strftime("%w", mktime(0, 0, 0, 12, 31, $year));
       
    $number = $isonumber = strftime("%W", $time);

    // According to strftime("%W"), 1st of january is in week 1 if and only if
it is a monday
    if ($first_day == 1)
        $isonumber--;

    // 1st of january is between monday and thursday; starting (now) at 0 when
it should be 1
    if ($first_day >= 1 && $first_day <= 4)
        $isonumber++;
    else if ($number == 0)
        $isonumber = week_isonumber(mktime(0, 0, 0, 12, 31, $year - 1));

    if ($isonumber == 53 && ($last_day == 1 || $last_day == 2 || $last_day == 3
))
        $isonumber = 1;

    return sprintf("%02d", $isonumber);
}
?>
===============================================================================

For all those who work with WampServer on Windows,
I propose you a formatting(layout) of date as " Friday, January 1st, 2016 "
instead of " Friday, January 01st, 2016 " (note the zero in front of 1) which
works at the same time on Windows / WampServer and on (on-line) Linux / waiter.
There are problems with "%e" - > which(who) works on Linux and not on Windows -
> "%#d" (this works on windows/wampserver)
I simply made a condition:
<?php
if ($_SERVER['SERVER_NAME'] == "website.com") // On line
{
   $number_of_the_day= "%e"; // Number of the day without "0"
}
else
{
   $number_of_the_day = "%#d";  // The same on Windows/Wampserver
}

setlocale(LC_TIME, 'fr_FR.utf8','fra'); // I'm french !

// i use this fonction ucfirst('string') for "V" Maj. and "J" Maj.

echo ucfirst(strftime('%A '.$number_of_the_day.' %B %Y'));

//  "Vendredi 1 Janvier 2016"  (->  without "0")
?>
Here we are, I hope to have helped.
===============================================================================

strftime() will get local time using timezone setting from
date_default_timezone_set, then send format and converted tm structure to
strftime() system call.

So it will output time stamp string ("%s" format string) with timezone
converted tm structure, and it will be wrong unless you set  the same time zone
with your machine.
===============================================================================

I had a need to subtrackt an older time from current time to get the time
between.
Example: If one has worked from 2009-03-16 11:33:54 to 2009-03-16 12:01:54 then
he has worked X hours,minutes and seconds. I tried to find that X. And so - one
solution would be:
<?php
$start_date = strtotime("2009-03-16 11:33:54"); //start date from database -
date("Y-m-d H:i:s") made as UNIX timestamp
$end_date = strtotime("2009-03-16 12:01:54"); //end date from database - date
("Y-m-d H:i:s") made as UNIX timestamp
$ajavahe = $end_date - $start_date;
$time_between = gmstrftime('%Hh %Mm %Ss', $ajavahe); //gmstrftime() deals with
different timezones correctly. (If in example you would be situated in Estonia
and you would use strftime() you get wrong answer off by 2 hrs, because
timezone is GMT+2 - with gmstrftime() comes right answer.)

echo 'You have worked: '.$time_between;
?>
Hope that this one makes someones life easier :D
===============================================================================

{--}, it is replaced on "today" or "yesterday"
===============================================================================

A small function to get the first weekday of the month.
For example the first monday of the month, or the first friday, etc.

<?php 
  /**
   *
   *  Gets the first weekday of that month and year
   *
   *  @param  int   The day of the week (0 = sunday, 1 = monday ... , 6 =
saturday)
   *  @param  int   The month (if false use the current month)
   *  @param  int   The year (if false use the current year)
   *
   *  @return int   The timestamp of the first day of that month
   *
   **/ 
  function get_first_day($day_number=1, $month=false, $year=false)
  {
    $month  = ($month === false) ? strftime("%m"): $month;
    $year   = ($year === false) ? strftime("%Y"): $year;
   
    $first_day = 1 + ((7+$day_number - strftime("%w", mktime(0,0,0,$month, 1, 
$year)))%7);
 
    return mktime(0,0,0,$month, $first_day, $year);
  }

// this will output the first wednesday of january 2007 (wed 03-01-2007)
echo strftime("%a %d-%m-%Y", get_first_day(3, 1, 2007));
?>
===============================================================================

Sometimes, you want Jan 1 to be week 1 and weeks to begin on Sunday. Here's a
way to use strftime U format character to follow this convention:
<?php
$month = 5; $year = 2012; echo "Week #'s in May 2012: ";
$week_num_correction = strftime('%U', mktime(0,0,0,1,1,$year)) === '00' ? 1 : 0
;
$week_numbers = range(strftime('%U', mktime(0,0,0,$month,1,$year)) + 
$week_num_correction, strftime('%U', mktime(0,0,0,$month+1,0,$year)) + 
$week_num_correction);
foreach($week_numbers as $week_number) echo "$week_number ";
?>
displays: Week #'s in May 2012: 18 19 20 21 22
===============================================================================

Why not use utf8_encode to fix problems with letters in ISO-8859-1 and charset
set to UTF-8?

For example:
<?php

setlocale(LC_TIME, "de_DE");
echo utf8_encode(strftime('%B')); // Output e.g.: März

?>
===============================================================================

for Arabic

<?php
setlocale(LC_ALL,'ar');
echo strftime('%A %d %B %Y');
?>
===============================================================================

Here is a function to convert dates before 1970, very useful if you are still
using php 4 (it is supported in php5) :

<?php
# convert a date to special format
# $date is like 2000-01-01 00:00:00
# $format : refer to strftime function
function convert_date($date,$format) {   
    if($date=='0000-00-00 00:00:00' OR $date=='0000-00-00' OR $date=='' OR 
$date==NULL) {
        return '';
    }
    else {
        $year=substr($date,0,4);
        if(phpversion() < 5.0 AND $year < 1970) {
           
            $new_date=substr_replace($date,'1980',0,4); # we replace the year
by a year after 1970       
            $new_format=eregi_replace('%a|%A|%u','',$format); # we remove days
information from the format because they would be wrong
            $new_date=strftime($new_format,strtotime($new_date)); # we convert
the date
            $new_date=eregi_replace('1980',$year,$new_date); # we put back the
real year
            return $new_date;
        }
        else {
            return strftime($format,strtotime($date));
        }
    }
}
?>
===============================================================================

To get a RFC 850 date (used in HTTP) of the current time:

gmstrftime ("%A %d-%b-%y %T %Z", time ());

This will get for example:
Friday 25-Jun-04 03:30:23 GMT

Please note that times in HTTP-headers _must_ be GMT, so use gmstrftime()
instead of strftime().
===============================================================================

This is so simple it has to be found in one of all the comments on all those
different time functions. But since I didn't find it, here it is: Use this to
convert between different time formats:

<?PHP
if (!function_exists('convertTime')) {
  /** Converts time strings from one format into another using
   *  PHP formats.
   *
   *  @param String $dformat Format to convert to
   *  @param String $sformat Format to convert from, e.g. format
   *      of $ts
   *  @param String $ts Time string to be converted
   *  @return String Supplied time translated to the format specified
   *    in $dformat
   */
  function convertTime($dformat,$sformat,$ts) {
    extract(strptime($ts,$sformat));
    return strftime($dformat,mktime(
                                  intval($tm_hour),
                                  intval($tm_min),
                                  intval($tm_sec),
                                  intval($tm_mon)+1,
                                  intval($tm_mday),
                                  intval($tm_year)+1900
                                ));
  }
}

/*
* And for the test....
*/
echo convertTime('%Y-%m-%d','%d.%m.%Y','27.11.2009');
?>

This should print "2009-27-11".

I did not put much effort in this code. The task also seems "too simple to be
neccessary". But as I said, I didn't find anything to help me with this.

Cheers,

Michael Z
===============================================================================

<?php
// Date string
$timestamp     =     strftime("%Y-%m-%d %H:%M:%S %Y");

// From this string ($timestamp) can we print
echo strftime("%a %d %b %H:%M:%S %Y", strtotime($timestamp))."<br/>";
echo strftime("%a %d %b %H:%M", strtotime($timestamp))."<br/>";
echo strftime("%Y-%m-%d %H:%M:%S", strtotime($timestamp))."<br/>";
echo strftime("%Y-%m-%d %H:%M", strtotime($timestamp))."<br/>";
echo strftime("%Y-%m-%d", strtotime($timestamp))."<br/>";
echo strftime("%a %d %b %Y", strtotime($timestamp))."<br/>";

/*And it will output

Wed 20 May 15:53:40 2009
Wed 20 May 15:53
2009-05-20 15:53:40
2009-05-20 15:53
2009-05-20
Wed 20 May 2009

*/
?>
