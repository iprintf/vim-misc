
MongoCursor::setReadPreference

(PECL mongo >=1.3.3)

MongoCursor::setReadPreference — Set the read preference for this query

说明

public MongoCursor MongoCursor::setReadPreference ( string $read_preference [, 
array $tags ] )

参数

read_preference

    The read preference mode: MongoClient::RP_PRIMARY,
    MongoClient::RP_PRIMARY_PREFERRED, MongoClient::RP_SECONDARY,
    MongoClient::RP_SECONDARY_PREFERRED, or MongoClient::RP_NEAREST.

tags

    An array of zero or more tag sets, where each tag set is itself an array of
    criteria used to match tags on replica set members.

返回值

Returns this cursor.

错误／异常

Emits E_WARNING if either parameter is invalid, or if one or more tag sets are
provided with the MongoClient::RP_PRIMARY read preference mode.

范例

Example #1 MongoCursor::setReadPreference() tag set array syntax example

<?php

$m = new MongoClient();
$cursor = $m->test->users->find();

// Prefer the nearest server in the "east" data center also used for reporting,
// but fall back to a server in the "west" data center
$cursor->setReadPreference(MongoClient::RP_NEAREST, array(
    array('dc' => 'east', 'use' => 'reporting'),
    array('dc' => 'west'),
));
?>

参见

  • The read preferences documentation.
  • MongoCursor::getReadPreference() - Get the read preference for this query
  • MongoCursorInterface::setReadPreference()

